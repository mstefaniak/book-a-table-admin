(this["webpackJsonpbook-a-table-admin"]=this["webpackJsonpbook-a-table-admin"]||[]).push([[0],{102:function(e,t,a){"use strict";a.r(t);var n,r=a(0),c=a.n(r),o=a(12),l=a.n(o),i=(a(89),a(16)),s=a(71),u=a(23),d=a.n(u),m=a(33),b=a(24),E=a(131),f=a(73),p=a(133),g=a(134),h=a(135),v=a(136),O=a(137),j=a(157),w=a(154),k=a(139),C=a(129),N=a(140),R=a(141),y=a(142),x=a(150),A=a(53),D=Object(r.createContext)({firebase:null}),S=a(128),W=a(155),P=a(156);!function(e){e[e.NEW=0]="NEW",e[e.CONFIRMED=1]="CONFIRMED",e[e.PREPARED=2]="PREPARED",e[e.REALIZED=3]="REALIZED",e[e.NOT_REALIZED=4]="NOT_REALIZED",e[e.CANCELED=5]="CANCELED"}(n||(n={}));var I,T={0:"New",1:"Confirmed",2:"Prepared",3:"Realized",4:"Not realized",5:"Canceled"};!function(e){e.CURRENT="current",e.NEXT="next",e.HISTORY="history"}(I||(I={}));var L,U=(L={},Object(b.a)(L,n.CANCELED,"default"),Object(b.a)(L,n.NEW,"default"),Object(b.a)(L,n.CONFIRMED,"default"),Object(b.a)(L,n.PREPARED,"secondary"),Object(b.a)(L,n.REALIZED,"primary"),Object(b.a)(L,n.NOT_REALIZED,"default"),L),Z=Object(C.a)((function(e){return{table:{minWidth:650},th:{fontWeight:e.typography.fontWeightBold,color:e.palette.common.white,backgroundColor:e.palette.common.black}}})),M=function(e){var t=e.type,a=function(e){var t=Object(r.useContext)(D).firebase,a=Object(r.useState)(!0),n=Object(i.a)(a,2),c=n[0],o=n[1],l=Object(r.useState)([]),s=Object(i.a)(l,2),u=s[0],b=s[1],E=function(e){if(o(!1),e.empty)console.warn("No matching documents");else{var t=e.docs.map((function(e){return Object(A.a)(Object(A.a)({},e.data()),{},{id:e.id})}));b(t)}},f=Object(r.useCallback)(Object(m.a)(d.a.mark((function a(){var n,r,c,o,l;return d.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(t){a.next=2;break}return a.abrupt("return");case 2:return n=t.firestore().collection("bookings"),r=null,c=Object(S.a)(Object(W.a)()),o=Object(S.a)(Object(P.a)()),(r=e===I.CURRENT?n.where("date",">",c).where("date","<",o).orderBy("date","asc"):e===I.NEXT?n.where("date",">=",o).orderBy("date","asc"):n.where("date","<=",c).orderBy("date","desc")).onSnapshot((function(e){E(e)}),(function(e){console.log("Encountered error: ".concat(e))})),a.next=10,r.get();case 10:l=a.sent,E(l);case 12:case"end":return a.stop()}}),a)}))),[t,e]);return Object(r.useEffect)((function(){f()}),[f]),{bookings:u,loading:c}}(t),o=a.bookings,l=a.loading,s=Object(r.useState)(!1),u=Object(i.a)(s,2),b=u[0],C=u[1],L=function(){var e=Object(r.useContext)(D).firebase;return{update:Object(r.useCallback)(function(){var t=Object(m.a)(d.a.mark((function t(a,n){var r;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return r=e.firestore().collection("bookings"),t.abrupt("return",r.doc(a).update(n));case 4:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),[e])}}().update,M=Z(),z=function(){var e=Object(m.a)(d.a.mark((function e(t,a){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C(!0),e.next=3,L(t,{status:a});case 3:C(!1);case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),B=Object(r.useCallback)((function(e){var a=new Date(e);return t===I.CURRENT?Object(x.a)(a,"HH:mm"):Object(x.a)(a,"yyyy-MM-dd HH:mm")}),[t]);return c.a.createElement(c.a.Fragment,null,o.length?c.a.createElement(E.a,{component:f.a},c.a.createElement(p.a,{className:M.table,"aria-label":"bookings list"},c.a.createElement(g.a,null,c.a.createElement(h.a,null,c.a.createElement(v.a,{className:M.th},"Who"),c.a.createElement(v.a,{className:M.th,align:"center"},"When"),c.a.createElement(v.a,{className:M.th,align:"center"},"Persons"),c.a.createElement(v.a,{className:M.th,align:"center"},"Where"),c.a.createElement(v.a,{className:M.th,align:"center"},"Status"),c.a.createElement(v.a,{className:M.th,align:"center"},"Comment"),c.a.createElement(v.a,{className:M.th}))),c.a.createElement(O.a,null,o.map((function(e){return c.a.createElement(h.a,{key:e.id},c.a.createElement(v.a,{component:"th",scope:"row"},e.name),c.a.createElement(v.a,{align:"center"},B(e.date)),c.a.createElement(v.a,{align:"center"},e.people),c.a.createElement(v.a,{align:"center"},e.area),c.a.createElement(v.a,{align:"center"},c.a.createElement(j.a,{color:U[e.status],label:T[e.status]})),c.a.createElement(v.a,{align:"center"},e.comment),c.a.createElement(v.a,{align:"right"},t===I.CURRENT&&e.status<n.PREPARED&&c.a.createElement(w.a,{title:"Mark prepared"},c.a.createElement(k.a,{edge:"end","aria-label":"prepared",disabled:b,onClick:function(){return z(e.id,n.PREPARED)}},c.a.createElement(N.a,null))),(t===I.CURRENT||t===I.HISTORY)&&e.status===n.PREPARED&&c.a.createElement(c.a.Fragment,null,c.a.createElement(w.a,{title:"Mark not realized"},c.a.createElement(k.a,{edge:"end","aria-label":"not realized",disabled:b,onClick:function(){return z(e.id,n.NOT_REALIZED)}},c.a.createElement(R.a,null))),c.a.createElement(w.a,{title:"Mark realized"},c.a.createElement(k.a,{edge:"end","aria-label":"realized",disabled:b,onClick:function(){return z(e.id,n.REALIZED)}},c.a.createElement(y.a,null))))))}))))):c.a.createElement("div",null,l?"Loading...":"No bookings found"))},z=a(143),B=a(144),H=a(149),F=a(145),K=a(146),_=Object(C.a)((function(e){return{error:{padding:e.spacing(1),color:e.palette.error.main,textAlign:"center"},content:{"& > *":{marginBottom:e.spacing(2)}},card:{maxWidth:400,margin:"40px auto"},actions:{justifyContent:"center"}}})),J=function(){var e=_(),t=Object(r.useState)(!1),a=Object(i.a)(t,2),n=a[0],o=a[1],l=Object(r.useState)(""),s=Object(i.a)(l,2),u=s[0],d=s[1],m=Object(r.useState)(""),b=Object(i.a)(m,2),E=b[0],f=b[1],p=Object(r.useContext)(D).firebase,g=function(e){"Enter"===e.key&&h()},h=function(){p&&p.auth().signInWithEmailAndPassword(u,E).catch((function(e){o(!0)}))};return c.a.createElement(z.a,{className:e.card},c.a.createElement(B.a,{className:e.content},n&&c.a.createElement("p",{className:e.error},"Incorrect email and/or password"),c.a.createElement(H.a,{label:"E-mail",autoFocus:!0,value:u,onChange:function(e){var t;o(!1),d(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value)},fullWidth:!0,onKeyPress:g}),c.a.createElement(H.a,{label:"Password",type:"password",value:E,onChange:function(e){var t;o(!1),f(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value)},fullWidth:!0,onKeyPress:g})),c.a.createElement(F.a,{className:e.actions},c.a.createElement(K.a,{variant:"contained",color:"primary",onClick:h},"Log in")))},X=a(151),Y=a(147),q=a(152),G=a(148),V=["children","value","index"],$=Object(C.a)((function(e){return{root:{position:"absolute",flexGrow:1,backgroundColor:e.palette.grey[100],top:0,bottom:0,right:0,left:0}}})),Q=function(e){var t=e.children,a=e.value,n=e.index,r=Object(s.a)(e,V);return c.a.createElement("div",Object.assign({role:"tabpanel",hidden:a!==n,id:"nav-tabpanel-".concat(n),"aria-labelledby":"nav-tab-".concat(n)},r),a===n&&c.a.createElement(X.a,{p:3},t))},ee=function(){var e=$(),t=Object(r.useState)(0),a=Object(i.a)(t,2),n=a[0],o=a[1],l=Object(r.useState)(!0),s=Object(i.a)(l,2),u=s[0],d=s[1],m=Object(r.useState)(!1),b=Object(i.a)(m,2),E=b[0],f=b[1],p=Object(r.useContext)(D).firebase;return Object(r.useEffect)((function(){p&&p.auth().onAuthStateChanged((function(e){e?(o(0),f(!0)):f(!1),d(!1)}))}),[p]),u?null:E?c.a.createElement("div",{className:e.root},c.a.createElement(Y.a,{position:"static"},c.a.createElement(q.a,{variant:"fullWidth",value:n,onChange:function(e,t){o(t),p&&3===t&&p.auth().signOut()},"aria-label":"nav tabs example"},c.a.createElement(G.a,{label:"Current"}),c.a.createElement(G.a,{label:"Upcoming"}),c.a.createElement(G.a,{label:"History"}),c.a.createElement(G.a,{label:"Sign out"}))),c.a.createElement(Q,{value:n,index:0},c.a.createElement(M,{type:I.CURRENT})),c.a.createElement(Q,{value:n,index:1},c.a.createElement(M,{type:I.NEXT})),c.a.createElement(Q,{value:n,index:2},c.a.createElement(M,{type:I.HISTORY}))):c.a.createElement("div",{className:e.root},c.a.createElement(J,null))},te=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ae(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var ne=a(70),re=a.n(ne),ce=(a(96),a(100),"book-a-table-prod"),oe={apiKey:"AIzaSyCE6mjxw8cnpm0Z5qW1PesKNCFZxJV0bkw",authDomain:"".concat(ce,".firebaseapp.com"),databaseURL:"https://".concat(ce,".firebaseio.com"),projectId:ce,storageBucket:"".concat(ce,".appspot.com"),messagingSenderId:"173934858452",appId:"1:173934858452:web:50fdcc7645b3d229572b41"},le=re.a.initializeApp(oe);l.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(D.Provider,{value:{firebase:le}},c.a.createElement(ee,null))),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("https://mstefaniak.github.io/book-a-table-admin",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("https://mstefaniak.github.io/book-a-table-admin","/service-worker.js");te?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):ae(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):ae(t,e)}))}}(),function(){var e=Object(S.a)(Object(P.a)())-Object(S.a)(new Date);setTimeout((function(){window.location.reload()}),e+10)}()},84:function(e,t,a){e.exports=a(102)},89:function(e,t,a){}},[[84,1,2]]]);
//# sourceMappingURL=main.40a1bf2d.chunk.js.map